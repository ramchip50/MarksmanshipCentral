{% extends 'app/BaseTemplate.html' %}

{% block content %}

{{ coffee }}
<br />
<br />

<div id="g_list" style="display:none">

    <table class="table table-dark">
        <thead>
            <tr>
                <th scope="col"></th>
                <th scope="col">Name</th>
                <th scope="col">Alias</th>
                <th scope="col">Weapon</th>
                <th scope="col">Creation Date</th>
            </tr>
        </thead>
        <tbody>
            {% for game in games %}
            <tr id="g_row{{game.id}}">
                <td>
                    <button type="button" onclick="game_approve('{{game.id}}')" name="pushme">Approve</button>
                    <button type="button" onclick="game_choose_replace('{{game.id}}','{{game.name}}')" name="pushme2">Replace</button>
                    <button type="button" onclick="game_edit('{{game.id}}','{{game.name}}','{{game.alias}}','{{game.weapon_id}}')" name="pushme3">Edit</button>
                </td>
                <td> {{game.name}}</td>
                <td> {{game.alias}}</td>
                <td> {{game.weapon}}</td>
                <td> {{game.createdon}}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div id="g_replace" style="display:none">

    <span id="g_origname">This name</span><input type="hidden" id="g_origid"/><br /><br />

    Choose Library Game:<input class="form-control basicAutoComplete" style="width:350px;" type="text" data-url="/game_autocomplete/" autocomplete="off" id="g_newname" /><br /><br />

    <button type="button" onclick="game_replace()" name="replace">Replace</button><button type="button" onclick="game_addalias()" name="replace">Add Alias</button>
    <button type="button" onclick="reset_g()" name="cancel">Cancel</button>

</div>

<div id="g_edit" style="display:none">

    <span id="g_editorigname">This name</span><input type="hidden" id="g_editorigid" /><br /><br />
    Alias: <input id="g_editalias" type="text" />
    Weapon:&nbsp;<select id="g_weapon">
        <option value="1">Pistol</option>
        <option value="2">Grenade</option>
        <option value="3">Flechette Gun</option>
        <option value="4">Plasma Carbine</option>
        <option value="5">Tribarrel</option>
        <option value="6">Rifle</option>
        <option value="7">Disruptor</option>
        <option value="8">Grenade Launcher</option>
        <option value="9">Plasma Rifle</option>
    </select>
    <button type="button" onclick="game_save()" name="save">Save</button><button type="button" onclick="reset_g()" name="cancel">Cancel</button>

</div>



{% endblock %}

        {% block script %}

<script src="https://cdn.jsdelivr.net/gh/xcash/bootstrap-autocomplete@v2.3.7/dist/latest/bootstrap-autocomplete.min.js"></script>


<script>

    $('.basicAutoComplete').autoComplete()

    $('.dropdown-menu').css({ 'top': 'auto', 'left': 'auto' })

    function game_approve(gameId) {

        $.get("/game_approve/", { game_id: gameId });
        rw = '#g_row' + gameId;
        $(rw).hide();
    }

    function game_choose_replace(gameId, gameName) {
        t = "Submitted Game: " + gameName;
        $('#g_origname').html(t);
        $('#g_origid').val(gameId);
        $('#g_list').hide();
        $('#g_replace').show();

    }

    function game_replace() {
        oldid = $('#g_origid').val();
        newname = $('#g_newname').val();
        $.get("/game_replace/", { old_id: oldid, new_name: newname, add_alias : false });
        rw = '#g_row' + oldid;
        $(rw).hide();
        reset_g();
    }

    function game_addalias() {
        oldid = $('#g_origid').val();
        newname = $('#g_newname').val();
        $.get("/game_replace/", { old_id: oldid, new_name: newname, add_alias: true });
        rw = '#g_row' + oldid;
        $(rw).hide();
        reset_g();
    }

    function game_edit(gameId,gameName,gameAlias,gameWeapon) {
        $('#g_weapon').val(gameWeapon);
        $('#g_editalias').val(gameAlias);
        t = "Submitted Game: " + gameName;
        $('#g_editorigname').html(t);
        $('#g_editorigid').val(gameId);
        $('#g_list').hide();
        $('#g_replace').hide();
        $('#g_edit').show();
    }

    function game_save() {
        g_id = $('#g_editorigid').val();
        g_alias = $('#g_editalias').val();
        g_weapon = $('#g_weapon').val();
        $.get("/game_save/", { game_id: g_id, alias: g_alias, weapon_id: g_weapon });
        rw = '#g_row' + g_id;
        $(rw).hide();
        reset_g();
    }

    function reset_g() {
        $('#g_list').show();
        $('#g_replace').hide();
        $('#g_edit').hide();
    }

</script>

        {% endblock %}






